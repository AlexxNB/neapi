{"version":3,"file":"bundle.js","sources":["../../client/index.js","../client-src/main.js"],"sourcesContent":["const endpoint = function (endpoint) {\n    check_globals();\n    if(endpoint === undefined) return window.neapi.endpoint;\n    window.neapi.endpoint = endpoint;\n}\n\nconst context = function (ctx) {\n    check_globals();\n    if(ctx === undefined) return window.neapi.context;\n    window.neapi.context = ctx;\n}\n\nconst onRequest = function (callback) {\n    check_globals();\n    if(callback === undefined) return window.neapi.onRequest;\n    window.neapi.onRequest = callback;\n}\n\nconst onResponce = function (callback) {\n    check_globals();\n    if(callback === undefined) return window.neapi.onResponce;\n    window.neapi.onResponce = callback;\n}\n\nconst init = function (params) {\n    if(params.endpoint !== undefined) endpoint(params.endpoint);\n    if(params.context !== undefined) context(params.context);\n    if(params.onRequest !== undefined) onRequest(params.onRequest);\n    if(params.onResponce !== undefined) onResponce(params.onResponce);\n}\n\nconst check_globals = function() {\n    if(!window) throw new Error('[NeAPI] Client can work only in browser');\n    if(!window.neapi) window.neapi = {\n        endpoint:'/api',\n        onResponce: ()=>{},\n        onRequest: ()=>{},\n        context:{}\n    }\n}\n\nconst responceValidator = function (responce) {\n    if(!responce.namespace) return false;\n    if(!responce.method) return false;\n    if(responce.error === undefined) return false;\n    if(responce.payload === undefined) return false;\n    if(responce.context === undefined) return false;\n    return true;\n}\n\nconst request = async (namespace,method,params) => {\n\n    let packet = {\n        namespace,\n        method,\n        params,\n        context:context()\n    }\n\n    const onRequestHook = onRequest();\n    onRequestHook(packet);\n    \n    let raw_responce = await fetch(endpoint(),{ \n        method: 'POST',\n        headers: {  \n            \"Content-type\": \"application/json; charset=UTF-8\"\n        }, \n        credentials: 'include',  \n        body: JSON.stringify(packet)\n    });\n\n    if(raw_responce.status !== 200) throw new Error('[NeAPI] Bad answer from server');\n\n    let responce = await raw_responce.json();\n\n    if(!responceValidator(responce)) throw new Error('[NeAPI] Invalid responce packet');\n\n    const onResponceHook = onResponce();\n    onResponceHook(responce);\n    \n    return {\n        error:  responce.error,\n        payload:responce.payload\n    };\n}\n\nexport default {\n    init,\n    context,\n    request\n}","import neapi from './../../client';\n\nneapi.init({\n    endpoint: '/api',\n    onRequest: (packet) => console.log('NeAPI Request:', packet),\n    onResponce: (packet) => console.log('NeAPI Responce:', packet)\n});\n\nexport function doCountAddition() {\n    const a = Number(document.getElementById('ex1_a').value);\n    const b = Number(document.getElementById('ex1_b').value);\n\n    neapi.request('algebra','addition',{a,b}).then((responce)=>{\n        console.log(responce);\n    })\n}\n"],"names":[],"mappings":"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"}